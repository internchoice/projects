<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Projects | Intern Choice Projects</title>
    <link rel="icon" href="https://internchoice.com/assets/img/intern_logo_t.png" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/style.css">
  <style>
    /* body {
      font-family: 'Montserrat', sans-serif;
      padding: 30px;
      background: var(--bg-color, #f9f9f9);
    } */
/* === Form Responsiveness === */
.form-box {
  background: var(--card-bg, #fff);
  padding: 20px;
  border-radius: 10px;
  max-width: 700px;
  margin: auto;
  box-shadow: 0 0 10px var(--shadow, rgba(0, 0, 0, 0.1));
  display: flex;
  flex-direction: column;
}

.form-box input,
.form-box select,
.form-box textarea,
.form-box button {
  width: 100%;
  margin-bottom: 12px;
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #ccc;
  font-size: 14px;
  box-sizing: border-box;
}

.form-box button {
  background: var(--accent-color, #007BFF);
  color: white;
  border: none;
  font-weight: bold;
  transition: background 0.3s;
}

.form-box button:hover {
  background: #0056b3;
}

/* === Project Card Grid === */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 20px;
  margin: 40px auto;
  max-width: 1200px;
  padding: 0 15px;
  box-sizing: border-box;
}

.card {
  background: var(--card-bg, #fff);
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px var(--shadow, rgba(0,0,0,0.1));
  display: flex;
  flex-direction: column;
}

.card button {
  margin-top: 10px;
  margin-right: 10px;
  background: var(--accent-color, #007BFF);
  border: none;
  padding: 6px 12px;
  color: white;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

.card button.delete {
  background: red;
}

/* === Media Queries for Smaller Screens === */
@media (max-width: 768px) {
  .form-box {
    padding: 15px;
  }

  .form-box input,
  .form-box select,
  .form-box textarea {
    font-size: 14px;
  }

  .card-grid {
    grid-template-columns: 1fr;
  }

  .card {
    padding: 15px;
  }

  .card p {
    font-size: 14px;
  }
}

@media (max-width: 480px) {
  .form-box h2 {
    font-size: 20px;
  }

  .form-box button {
    font-size: 14px;
    padding: 10px;
  }

  .card h3 {
    font-size: 18px;
  }

  .card button {
    font-size: 13px;
  }
}

    .form-box {
      background: var(--card-bg, #fff);
      padding: 20px;
      border-radius: 10px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0 0 10px var(--shadow, rgba(0, 0, 0, 0.1));
    }

    .form-box h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .form-box input, .form-box select, .form-box textarea {
      width: 100%;
      margin-bottom: 12px;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    .form-box button {
      padding: 10px 20px;
      background: var(--accent-color, #007BFF);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
    }

    .form-box button:hover {
      background: #0056b3;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 40px;
    }

    .card {
      background: var(--card-bg, #fff);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px var(--shadow, rgba(0,0,0,0.1));
    }

    .card h3 {
      margin-bottom: 10px;
    }

    .card small {
      color: gray;
      display: block;
      margin-bottom: 10px;
    }

    .card button {
      margin-top: 10px;
      margin-right: 10px;
      background: var(--accent-color, #007BFF);
      border: none;
      padding: 6px 12px;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    .card button.delete {
      background: red;
    }
    .card {
  background: var(--card-bg, #fff);
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px var(--shadow, rgba(0,0,0,0.1));
  display: flex;
  flex-direction: column;
  overflow-wrap: break-word;  /* ensures long words break */
  word-break: break-word;
  box-sizing: border-box;
  max-width: 100%;
}

  </style>
</head>
<body>
  <button class="theme-toggle-btn" id="theme-toggle">ðŸŒ™</button>
  <!-- Navbar -->
  <nav>
    <div class="logo-container">
      <img src="../assets/img/intern_logo_t.png" class="logo-light" alt="Logo Light">
      <img src="../assets/img/logo_t.png" class="logo-dark" alt="Logo Dark">
    </div>
    <button class="nav-toggle" id="nav-toggle">&#9776;</button>
    <div class="nav-links" id="nav-links">
      <a href="dashboard.html">Home</a>
      <a href="domain.html">Domains</a> 
      <a href="sub.html">Sub Domains</a>
      <a href="profile.html">Profile</a>
      <a href="manage.html">Details</a>
      <!-- <a href="login.html" class="btn" id="authButton">Login / Signup</a> -->
    </div>
  </nav>

<div class="form-box">
  <h2>Add or Edit Project</h2>

  <select id="domainSelect">
    <option value="">Select Domain</option>
  </select>

  <select id="titleSelect">
    <option value="">Select Project Title</option>
  </select>

  <input type="text" id="price" placeholder="Price (e.g., â‚¹1499)">
  <input type="text" id="discount" placeholder="Discount (e.g., 20% OFF)">
  <input type="text" id="stock" placeholder="Stock (e.g., In Stock)">
  <textarea id="description" placeholder="Project Description"></textarea>
  <textarea id="info" placeholder="Additional Info (comma-separated)"></textarea>

  <input type="text" id="language" placeholder="Language (e.g., Python)">
  <input type="text" id="hardware" placeholder="Hardware (e.g., DHT11)">
  <input type="text" id="cloud" placeholder="Cloud (e.g., Firebase)">
  <input type="text" id="delivery" placeholder="Delivery Time (e.g., 3 Days)">

  <button onclick="addOrUpdate()">Save Project</button>
</div>

<div class="card-grid" id="projectsGrid">
  <!-- Project cards will appear here -->
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/11.10.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAyNLRVP-y_QQd5IGH-QaKTCMiruF-dA6E",
    authDomain: "ic-project-6989d.firebaseapp.com",
    projectId: "ic-project-6989d",
    storageBucket: "ic-project-6989d.appspot.com",
    messagingSenderId: "90473196739",
    appId: "1:90473196739:web:db4e82108c0355a2fb0676"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const domainSelect = document.getElementById('domainSelect');
  const titleSelect = document.getElementById('titleSelect');
  const grid = document.getElementById('projectsGrid');
  let editId = null;

  async function loadDomains() {
    const domains = await db.collection("domains").get();
    domains.forEach(doc => {
      domainSelect.innerHTML += `<option value="${doc.data().slug}">${doc.data().name}</option>`;
    });
  }

  async function filterTitlesByDomain(domain) {
    titleSelect.innerHTML = `<option value="">Select Project Title</option>`;
    if (!domain) return;
    const projects = await db.collection("projects").where("domain", "==", domain).get();
    projects.forEach(doc => {
      const data = doc.data();
      titleSelect.innerHTML += `<option value="${data.slug}">${data.title || data.name}</option>`;
    });
  }

  domainSelect.addEventListener('change', () => {
    const selectedDomain = domainSelect.value;
    filterTitlesByDomain(selectedDomain);
  });

  async function addOrUpdate() {
    const domain = domainSelect.value;
    const slug = titleSelect.value;
    const title = titleSelect.options[titleSelect.selectedIndex]?.text || "";
    const price = document.getElementById('price').value;
    const discount = document.getElementById('discount').value;
    const stock = document.getElementById('stock').value;
    const description = document.getElementById('description').value;
    const info = document.getElementById('info').value.split(',').map(i => i.trim());
    const language = document.getElementById('language').value;
    const hardware = document.getElementById('hardware').value;
    const cloud = document.getElementById('cloud').value;
    const delivery = document.getElementById('delivery').value;

    const data = {
      domain, slug, title, price, discount, stock,
      description, info, language, hardware, cloud, delivery
    };

    if (editId) {
      await db.collection("projectDetails").doc(editId).update(data);
      editId = null;
    } else {
      await db.collection("projectDetails").add(data);
    }

    clearForm();
    loadProjects();
  }

  function clearForm() {
    domainSelect.value = '';
    titleSelect.innerHTML = `<option value="">Select Project Title</option>`;
    document.getElementById('price').value = '';
    document.getElementById('discount').value = '';
    document.getElementById('stock').value = '';
    document.getElementById('description').value = '';
    document.getElementById('info').value = '';
    document.getElementById('language').value = '';
    document.getElementById('hardware').value = '';
    document.getElementById('cloud').value = '';
    document.getElementById('delivery').value = '';
  }

  async function loadProjects() {
    grid.innerHTML = "";
    const snap = await db.collection("projectDetails").get();
    snap.forEach(doc => {
      const data = doc.data();
      const card = document.createElement('div');
      card.className = "card";
      card.innerHTML = `
        <h3>${data.title}</h3>
        <small>${data.domain}</small>
        <p>${data.price} - <strong>${data.discount}</strong></p>
        <p>Stock: ${data.stock}</p>
        <p>${data.description}</p>
        <p><strong>Language:</strong> ${data.language || 'N/A'}</p>
        <p><strong>Hardware:</strong> ${data.hardware || 'N/A'}</p>
        <p><strong>Cloud:</strong> ${data.cloud || 'N/A'}</p>
        <p><strong>Delivery:</strong> ${data.delivery || 'N/A'}</p>
        <button onclick="editProject('${doc.id}', ${JSON.stringify(data).replace(/"/g, '&quot;')})">Edit</button>
        <button class="delete" onclick="deleteProject('${doc.id}')">Delete</button>
      `;
      grid.appendChild(card);
    });
  }

  function editProject(id, data) {
    editId = id;
    domainSelect.value = data.domain;
    filterTitlesByDomain(data.domain).then(() => {
      titleSelect.value = data.slug;
    });
    document.getElementById('price').value = data.price;
    document.getElementById('discount').value = data.discount;
    document.getElementById('stock').value = data.stock;
    document.getElementById('description').value = data.description;
    document.getElementById('info').value = (data.info || []).join(", ");
    document.getElementById('language').value = data.language || '';
    document.getElementById('hardware').value = data.hardware || '';
    document.getElementById('cloud').value = data.cloud || '';
    document.getElementById('delivery').value = data.delivery || '';
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  async function deleteProject(id) {
    if (confirm("Are you sure you want to delete this project?")) {
      await db.collection("projectDetails").doc(id).delete();
      loadProjects();
    }
  }

  loadDomains();
  loadProjects();
</script>
<script src="../assets/js/script.js"></script>
</body>
</html>
